(this.webpackJsonpspotifood=this.webpackJsonpspotifood||[]).push([[0],{153:function(e,t,a){},154:function(e,t,a){},156:function(e,t,a){},217:function(e,t,a){},218:function(e,t,a){},219:function(e,t,a){},220:function(e,t,a){},232:function(e,t,a){},233:function(e,t,a){},234:function(e,t,a){},235:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(16),l=a.n(i),c=a(7),s=a(17),o=a.n(s),u=a(29),m=(a(108),Object(n.createContext)()),f=function(e){var t=e.children,a=e.initialPlaylists,i=Object(n.useState)(a),l=Object(c.a)(i,2),s=l[0],o=l[1];return r.a.createElement(m.Provider,{value:{playlists:s,setPlaylists:o}},t)};f.defaultProps={initialPlaylists:null};var d=f,p=a(10),v=a.n(p),E=a(21),b=a(33),h=a(42),y=a(25),g=a.n(y),O=(a(153),function(e){var t=e.formik,a=e.field,n=e.type,i=e.placeholder,l=e.styleType,c=g()(a,"validation.min"),s=g()(a,"validation.max");return r.a.createElement("div",{className:"field"},r.a.createElement("label",{htmlFor:a.id},a.name),r.a.createElement("input",{className:v()("input",{"input--is-white":"white"===l}),id:a.id,type:n,placeholder:i,onChange:t.handleChange,value:t.values[a.id],min:c||0,max:s,step:"1"}))});O.defaultProps={type:"text",placeholder:"",styleType:"dark"};var _=O,w=(a(154),function(e){var t=e.formik,a=e.field;return r.a.createElement("div",{className:"select-input field"},r.a.createElement("label",{htmlFor:a.id},a.name),r.a.createElement("div",{className:"select"},r.a.createElement("select",{id:a.id,onChange:t.handleChange},r.a.createElement("option",{value:""}," "),a.values.map((function(e){return r.a.createElement("option",{key:e.value,value:e.value},e.name)})))))}),N=a(82),j=a.n(N),k=(a(155),a(156),{REFRESH_INTERVAL:3e4,DESKTOP_DEVICE_BREAKPOINT:1024,CLIENT_ID:"d7bbdae96bfa431fba63fb1f4b3cf9b4",REDIRECT_URL:"https://luanorlandi.github.io/spotifood"}),C=k.DESKTOP_DEVICE_BREAKPOINT,I=function(){var e=Object(n.useState)({}),t=Object(c.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){r({isTouch:window.innerWidth<C,isDesktop:window.innerWidth>=C})}),[]),a},S=function(e){var t=e.formik,a=e.field,n=I().isTouch;return r.a.createElement("div",{className:"datepicker field"},r.a.createElement("label",{htmlFor:a.id},a.name),!n&&r.a.createElement(j.a,{id:a.id,selected:t.values[a.id],onChange:function(e){return t.setFieldValue(a.id,e)},showTimeSelect:!0,timeIntervals:60,className:"input"}),n&&r.a.createElement("input",{id:a.id,className:"input",type:"datetime-local",onChange:function(e){var n=e.target.value,r=new Date(n).toISOString();t.setFieldValue(a.id,r)}}))},R=a(26),T=a.n(R),x=function(e){return Object.entries(e).reduce((function(e,t){var a=Object(c.a)(t,2),n=a[0],r=a[1];return""===r?e:Object(b.a)({},e,Object(E.a)({},n,r))}),{})},P=function(e){var t,a;return T.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=x(e),n.next=3,T.a.awrap(o.a.get("https://api.spotify.com/v1/browse/featured-playlists",{params:t}));case 3:return a=n.sent,n.abrupt("return",a.data.playlists.items);case 5:case"end":return n.stop()}}))},F=(a(217),k.REFRESH_INTERVAL),D=function(e){return e.reduce((function(e,t){return Object(b.a)({},e,Object(E.a)({},t.id,""))}),{})},L=function(e){var t=e.filters,a=e.closeNavbar,i=Object(n.useContext)(m).setPlaylists,l=Object(n.useRef)(null),c=Object(h.a)({initialValues:D(t),onSubmit:function(e,t){var n=t.setSubmitting;l.current&&clearInterval(l.current),P(e).then((function(t){i(t),a(),l.current=setInterval((function(){P(e).then((function(e){return i(e)})).catch((function(){return clearInterval(l.current)}))}),F)})).finally((function(){return n(!1)}))}});return r.a.createElement("form",{className:"filters",onSubmit:c.handleSubmit},r.a.createElement("div",{className:"filters__fields"},t.map((function(e){return function(e){if(e.values)return r.a.createElement(w,{formik:c,field:e,key:e.id});if(e.validation&&"DATE_TIME"===e.validation.entityType)return r.a.createElement(S,{formik:c,field:e,key:e.id});if(e.validation&&"INTEGER"===e.validation.primitiveType)return r.a.createElement(_,{type:"number",formik:c,field:e,key:e.id});throw new Error("Unknow filter type in '".concat(e.id,"'"))}(e)}))),r.a.createElement("button",{type:"submit",className:v()("button is-primary is-fullwidth",{"is-loading":c.isSubmitting})},"Buscar playlists"))};L.defaultProps={closeNavbar:function(){}};var V=L,z=function(){var e;return T.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.a.awrap(o.a.get("https://www.mocky.io/v2/5a25fade2e0000213aa90776"));case 2:return e=t.sent,t.abrupt("return",e.data.filters);case 4:case"end":return t.stop()}}))};function A(){return(A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function B(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var M=r.a.createElement("path",{fill:"currentColor",d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"}),U=function(e){var t=e.svgRef,a=e.title,n=B(e,["svgRef","title"]);return r.a.createElement("svg",A({"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"search",className:"svg-inline--fa fa-search fa-w-16",role:"img",viewBox:"0 0 512 512",ref:t},n),a?r.a.createElement("title",null,a):null,M)},K=r.a.forwardRef((function(e,t){return r.a.createElement(U,A({svgRef:t},e))})),W=(a.p,a(218),function(){var e=Object(n.useState)(null),t=Object(c.a)(e,2),a=t[0],i=t[1],l=Object(n.useState)(!1),s=Object(c.a)(l,2),o=s[0],u=s[1];return Object(n.useEffect)((function(){z().then((function(e){return i(e)}))}),[]),null===a?r.a.createElement("nav",{className:"navbar-filter"}):r.a.createElement(r.a.Fragment,null,r.a.createElement("nav",{className:v()("navbar-filter",{"navbar-filter--is-open":o})},r.a.createElement(V,{filters:a,closeNavbar:function(){return u(!1)}})),r.a.createElement("button",{className:"navbar-filter__button",type:"button","aria-label":"Abrir menu para buscar playlists",onClick:function(){return u(!0)}},r.a.createElement(K,{className:"navbar-filter__button-icon"})),o&&r.a.createElement("div",{className:"navbar-filter__overlay",onClick:function(){return u(!1)}}))}),H=(a(219),function(e){var t=e.playlist,a=t.name,n=t.description,i=g()(t,"images[0].url"),l=g()(t,"external_urls.spotify");return r.a.createElement("a",{href:l,className:"playlist-card"},r.a.createElement("img",{className:"playlist-card__image",src:i,alt:"Capa da playlist"}),r.a.createElement("div",null,r.a.createElement("div",{className:"playlist-card__title"},a),r.a.createElement("div",null,n)))}),J=function(e,t){var a=t.toLowerCase();return e.filter((function(e){return e.name.toLowerCase().includes(a)}))},q=(a(220),function(){var e=Object(n.useContext)(m).playlists,t=Object(n.useState)([]),a=Object(c.a)(t,2),i=a[0],l=a[1],s=Object(h.a)({initialValues:{name:""}});return Object(n.useEffect)((function(){var t=!!s.values.name;if(e&&t){var a=J(e,s.values.name);l(a)}else l(e)}),[e,s.values.name]),r.a.createElement("div",{className:"playlists"},r.a.createElement(_,{formik:s,field:{id:"name"},placeholder:"Filtrar pelo nome da playlist",styleType:"white"}),r.a.createElement("div",{className:"playlists__cards"},i&&i.map((function(e){return r.a.createElement(H,{key:e.id,playlist:e})}))))}),G=function(){var e=Object(n.useContext)(m).setPlaylists;return Object(n.useEffect)((function(){P({}).then((function(t){return e(t)}))}),[e]),r.a.createElement(r.a.Fragment,null,r.a.createElement(W,null),r.a.createElement(q,null))},$=k.CLIENT_ID,Q=k.REDIRECT_URL,X=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"app__login"},r.a.createElement("h1",{className:"app__login-title"},"Spotifood"),r.a.createElement("h2",{className:"app__login-description"},"Pesquise pelas suas playlists preferidas"),r.a.createElement("a",{className:"button is-primary",href:"https://accounts.spotify.com/authorize?response_type=token&client_id=".concat($,"&redirect_uri=").concat(encodeURIComponent(Q))},"Fazer login com Spotify")))},Y=a(85),Z=a.n(Y),ee=(a(232),k.CLIENT_ID),te=k.REDIRECT_URL,ae=function(e){var t=e.sessionExpired,a=e.errorMessage;return t?r.a.createElement("div",{className:"toast toast--is-center"},r.a.createElement("div",{className:"toast__message"},"Sua sess\xe3o expirou"),r.a.createElement("div",null,r.a.createElement("a",{className:"button is-primary is-small",href:"https://accounts.spotify.com/authorize?response_type=token&client_id=".concat(ee,"&redirect_uri=").concat(encodeURIComponent(te))},"Fazer login novamente"))):r.a.createElement("div",{className:"toast"},r.a.createElement("div",{className:"toast__message"},"Falha no servidor:"),r.a.createElement("pre",null,a))};ae.defaultProps={sessionExpired:!1,errorMessage:""};var ne=ae,re=function(e){if(e.response)if(401===e.response.status)Object(u.b)(ne({sessionExpired:!0})),localStorage.removeItem("token");else{var t=e.response.data.error,a=t.status,n=t.message,r="".concat(a,": ").concat(n);Object(u.b)(ne({errorMessage:r}))}return Promise.reject(e)};a(233),a(234);o.a.interceptors.response.use(null,re);var ie=function(){var e=Object(n.useState)(!0),t=Object(c.a)(e,2),a=t[0],i=t[1],l=Object(n.useState)(!1),s=Object(c.a)(l,2),m=s[0],f=s[1];return Object(n.useEffect)((function(){var e=function(){var e=localStorage.getItem("token");return e||(e=Z.a.parse(window.location.hash).access_token,window.history.pushState(null,"",window.location.href.split("#")[0])),e}();e&&(!function(e){localStorage.setItem("token",e),o.a.defaults.headers.common.Authorization="Bearer ".concat(e)}(e),f(!0)),i(!1)}),[]),a?null:r.a.createElement(d,null,r.a.createElement(u.a,{position:"top-left",autoClose:!1,closeOnClick:!1,pauseOnVisibilityChange:!0}),r.a.createElement("div",{className:"app"},m&&r.a.createElement(G,null),!m&&r.a.createElement(X,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(ie,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},86:function(e,t,a){e.exports=a(235)}},[[86,1,2]]]);
//# sourceMappingURL=main.6b01e40c.chunk.js.map